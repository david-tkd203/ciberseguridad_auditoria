# üõ°Ô∏è SGSI - Sistema de Gesti√≥n de Seguridad de la Informaci√≥n v4.0

[![ISO 27001:2022](https://img.shields.io/badge/ISO%2027001-2022-blue.svg)](https://www.iso.org/standard/27001)
[![MITRE ATT&CK](https://img.shields.io/badge/MITRE-ATT%26CK-red.svg)](https://attack.mitre.org/)
[![Excel](https://img.shields.io/badge/Excel-2016%2B-green.svg)](https://www.microsoft.com/excel)
[![VBA Macros](https://img.shields.io/badge/VBA-21%20Macros-orange.svg)](https://docs.microsoft.com/office/vba/api/overview/excel)

---

## üìã Descripci√≥n General

**Sistema completo y profesional** de gesti√≥n de seguridad de la informaci√≥n (SGSI) que implementa **todas las exigencias de la norma ISO 27001:2022**. Este sistema proporciona documentaci√≥n completa, herramientas automatizadas y procesos robustos para **implementar, gestionar y certificar** un SGSI de clase mundial.

### üéØ Prop√≥sito

Facilitar la implementaci√≥n de un SGSI certificable bajo ISO 27001:2022, proporcionando:
- ‚úÖ **Documentaci√≥n completa** de 45 hojas estructuradas
- ‚úÖ **Automatizaci√≥n total** con 21 macros VBA
- ‚úÖ **Gesti√≥n integral** de activos, riesgos, controles e incidentes
- ‚úÖ **Framework MITRE ATT&CK** integrado para an√°lisis de amenazas
- ‚úÖ **Sistema listo para auditor√≠a** y certificaci√≥n

### üèÜ Beneficios Clave

| Beneficio | Descripci√≥n |
|-----------|-------------|
| üíº **Ahorro de Tiempo** | Sistema preconfigurado elimina 200+ horas de trabajo manual |
| ü§ñ **Automatizaci√≥n** | 21 macros VBA reducen errores y aceleran procesos |
| üìà **Escalabilidad** | Desde startups hasta grandes corporaciones |


---

## ‚ú® Caracter√≠sticas Principales del Sistema

### üìä **1. Gesti√≥n Integral de Activos**

El sistema permite inventariar y clasificar todos los activos de informaci√≥n de la organizaci√≥n:

- **üíº Inventario Completo**: Registra hardware, software, datos, servicios, personal e instalaciones
- **üîñ Clasificaci√≥n Multinivel**: Categor√≠as, subcategor√≠as, √°reas y clases personalizables
- **üó∫Ô∏è Ubicaci√≥n Precisa**: Seguimiento de ubicaci√≥n f√≠sica y l√≥gica de cada activo
- **üí∞ Valoraci√≥n**: Asignaci√≥n de valor econ√≥mico y criticidad (C/I/D)
- **üìä Dashboard Visual**: Panel de control con m√©tricas en tiempo real

**Hoja Principal**: `Activos` (Inventario maestro con IDs autom√°ticos ACT-2025-XXX)

---

### ‚ö†Ô∏è **2. An√°lisis y Gesti√≥n de Riesgos**

Metodolog√≠a robusta de an√°lisis de riesgos basada en matriz 5√ó5:

- **üìä Matriz Probabilidad √ó Impacto**: Escala de 1 a 5 en ambos ejes (riesgo 1-25)
- **üßÆ C√°lculo Autom√°tico**: Riesgo Inherente y Residual calculados por macros
- **üé® C√≥digo de Colores**: Verde (Bajo), Amarillo (Medio), Naranja (Alto), Rojo (Cr√≠tico)
- **üó∫Ô∏è Mapa de Calor Visual**: Matriz 5√ó5 con distribuci√≥n de riesgos
- **üìà An√°lisis de Brechas**: Identifica diferencias entre riesgo actual y aceptable

**Hojas Principales**: 
- `Matriz_Riesgos` (Registro de todos los riesgos identificados)
- `Analisis_Riesgos` (An√°lisis detallado y evaluaci√≥n)
- `Metodologia_Riesgos` (Escala de probabilidad e impacto)

---

### ÔøΩÔ∏è **3. Controles ISO 27001:2022 (Anexo A)**

Implementaci√≥n completa de los 93 controles del Anexo A:

- **üìã 93 Controles Documentados**: Todos los controles de las 4 categor√≠as
  - ÔøΩ A.5 - Controles Organizacionales (37 controles)
  - üë• A.6 - Controles de Personas (8 controles)
  - üîß A.7 - Controles F√≠sicos (14 controles)
  - üíª A.8 - Controles Tecnol√≥gicos (34 controles)

- **‚úÖ Statement of Applicability (SOA)**: Justificaci√≥n de aplicabilidad de cada control
- **üìä Trazabilidad Completa**: Vinculaci√≥n controles ‚Üî riesgos ‚Üî activos
- **üìà M√©tricas de Cumplimiento**: % de implementaci√≥n por categor√≠a

**Hojas Principales**:
- `Controles_ISO27001` (93 controles del Anexo A)
- `Declaracion_Aplicabilidad` (SOA mejorado)
- `SoA` (Statement of Applicability completo)

---

### üö® **4. Gesti√≥n de Incidentes de Seguridad**

Proceso estructurado de gesti√≥n de incidentes en 7 fases:

1. **Detecci√≥n**: Identificaci√≥n temprana del incidente
2. **Registro**: Documentaci√≥n inicial con ID √∫nico
3. **Clasificaci√≥n**: 12 tipos (Malware, Phishing, DDoS, Breach, etc.)
4. **An√°lisis**: Evaluaci√≥n de severidad (Cr√≠tica/Alta/Media/Baja)
5. **Contenci√≥n**: Acciones inmediatas para limitar da√±o
6. **Erradicaci√≥n**: Eliminaci√≥n de la causa ra√≠z
7. **Cierre**: Documentaci√≥n de lecciones aprendidas

**Tiempos de Respuesta**:
- üî¥ **Cr√≠tica**: 15-30 minutos
- ÔøΩ **Alta**: 1-2 horas
- üü° **Media**: 2-4 horas
- üü¢ **Baja**: 8-24 horas

**Hojas Principales**:
- `Gestion_Incidentes` (Registro de incidentes)
- `Clasificacion_Incidentes` (12 tipos + matriz severidad)
- `Registro_Eventos` (Log de eventos de seguridad)

---

### üéØ **5. Framework MITRE ATT&CK Integrado**

Mapeo de t√©cnicas y t√°cticas de ataques cibern√©ticos:

- **üìä Base de Datos Completa**: T√©cnicas de MITRE ATT&CK v17.1
- **üè≠ Enfoque ICS**: Amenazas espec√≠ficas para sistemas industriales
- **üîó Vinculaci√≥n Riesgos**: Cada riesgo puede asociarse a t√©cnicas MITRE
- **ÔøΩ An√°lisis de Cobertura**: Identifica gaps en detecci√≥n y respuesta
- **üéØ T√°cticas Documentadas**: Initial Access, Execution, Persistence, etc.

**Ejemplos de T√©cnicas**:
- T1566 - Phishing
- T1078 - Valid Accounts  
- T1486 - Data Encrypted for Impact (Ransomware)

**Hojas Principales**:
- `MITRE_Ataques` (Cat√°logo de t√°cticas y t√©cnicas)
- `Inventario_Amenazas` (Amenazas espec√≠ficas con MITRE ATT&CK)

---

### ü§ñ **6. Automatizaci√≥n con 21 Macros VBA**

Sistema inteligente de automatizaci√≥n que elimina tareas repetitivas:

#### **M√≥dulo Activos** (7 macros)
- `IngresarNuevoActivo` - Agregar activo con validaci√≥n y ID autom√°tico
- `AgregarCategoria` - Gestionar categor√≠as (Hardware/Software/Informaci√≥n)
- `AgregarArea` - Administrar √°reas organizacionales
- `AgregarClase` - Clasificar por confidencialidad/integridad/disponibilidad

#### **M√≥dulo Riesgos** (5 macros)
- `IngresarNuevoRiesgo` - Registrar nuevo riesgo con c√°lculo P√óI
- `CalcularRiesgoInherente` - Evaluar riesgo sin controles
- `CalcularRiesgoResidual` - Evaluar riesgo post-controles
- `ColorearRiesgos` - Aplicar formato visual autom√°tico
- `GenerarMapaCalor` - Crear matriz 5√ó5 visual

#### **M√≥dulo Tratamientos** (3 macros)
- `IngresarNuevoTratamiento` - Crear plan de mitigaci√≥n
- `ActualizarEstadoTratamiento` - Seguimiento de implementaci√≥n
- `GenerarInformeTratamiento` - Reportes ejecutivos

#### **M√≥dulo Reportes** (4 macros)
- `ActualizarDashboard` - Refrescar m√©tricas en tiempo real
- `ExportarReporteCompleto` - PDF con 7 hojas principales
- `ExportarActivosPDF` - Exportar solo inventario de activos
- `ValidarCumplimientoISO` - Checklist de cumplimiento

#### **Utilidades** (2 macros)
- `MostrarInfoSistema` - Informaci√≥n del SGSI
- `ValidarEstructuraExcel` - Verificar integridad

**Caracter√≠sticas Avanzadas**:
- ‚úÖ Validaci√≥n de datos y duplicados
- ‚úÖ IDs autom√°ticos con formato ACT-YYYY-###
- ‚úÖ Confirmaciones antes de acciones cr√≠ticas
- ‚úÖ Manejo robusto de errores
- ‚úÖ Log de auditor√≠a autom√°tico
- ‚úÖ Mensajes informativos con emojis

---

### üìä **7. Dashboard Ejecutivo y M√©tricas**

Panel de control interactivo con KPIs en tiempo real:

**M√©tricas Principales**:
- üíº **Total de Activos**: Inventariados y clasificados
- ‚ö†Ô∏è **Riesgos Activos**: Por nivel de criticidad
- üîí **Controles Implementados**: X de 93 (XX%)
- üö® **Incidentes Abiertos**: En gesti√≥n activa

**Distribuciones**:
- Activos por categor√≠a (Hardware, Software, Datos, Servicios)
- Riesgos por nivel (Bajo, Medio, Alto, Cr√≠tico)
- Tratamientos por estado (Planificado, En Curso, Completado)
- Cumplimiento ISO por categor√≠a (A.5, A.6, A.7, A.8)

**Actualizaci√≥n**: Un clic con macro `ActualizarDashboard`

**Hoja Principal**: `Dashboard` (M√©tricas y visualizaciones)

---

### ÔøΩ **8. Documentaci√≥n ISO 27001 Completa**

Sistema incluye **toda la documentaci√≥n** exigida por la norma:

#### **Documentaci√≥n Estrat√©gica**
- üìã **Pol√≠ticas de Seguridad** (10 pol√≠ticas fundamentales)
- ÔøΩ **Plan Proyecto SGSI** (Roadmap de implementaci√≥n 12 meses)
- üìä **Plan Director Ciberseguridad** (Estrategia 2025-2027)
- üëî **Revisi√≥n por Direcci√≥n** (Reuniones trimestrales)

#### **Documentaci√≥n Operativa**
- üìñ **Procedimientos** (Backup, Control de acceso, Gesti√≥n cambios)
- ÔøΩ **Registros** (Auditor√≠as, Formaci√≥n, Incidentes, Eventos)
- üîê **NDAs** (Empleados y Proveedores)
- üìä **BIA** (Business Impact Analysis con RPO/RTO)

#### **Planes de Continuidad**
- üîÑ **Plan de Continuidad de Negocio** (BCP completo)
- üÜò **Plan de Contingencia** (Respuesta a emergencias)
- üõ°Ô∏è **Plan DRP** (Disaster Recovery con pruebas/informes/mantenimiento)

#### **Control y Configuraci√≥n**
- ÔøΩ **Control de Documentos** (Versiones, aprobaciones, cambios)
- üíæ **CMDB** (Configuration Management Database)
- üîí **Procedimiento Hardening** (Windows/Linux/Bases de datos)
- üìù **Log de Acciones** (Auditor√≠a autom√°tica de cambios)

---

### üéì **9. Gesti√≥n de Formaci√≥n y Concienciaci√≥n**

Programa estructurado de capacitaci√≥n en seguridad:

**Componentes**:
- ÔøΩ **Plan de Formaci√≥n Anual**: Calendario de capacitaciones
- üìä **Registro de Asistencia**: Tracking de participantes
- üéØ **Temas Cubiertos**: 
  - Seguridad de la informaci√≥n b√°sica
  - Gesti√≥n de contrase√±as
  - Phishing y ingenier√≠a social
  - GDPR y privacidad de datos
  - Respuesta a incidentes

**Evaluaciones**:
- Cuestionarios pre/post formaci√≥n
- Simulacros de phishing
- Certificados de cumplimiento

**Hoja Principal**: `Registro_Formacion`

---

### üîç **10. Auditor√≠as y Cumplimiento**

Sistema robusto de auditor√≠as internas y externas:

**Plan de Auditor√≠a**:
- ÔøΩ **Calendario Anual**: Auditor√≠as programadas
- üéØ **Alcance Definido**: Procesos y controles a auditar
- üë• **Equipo Auditor**: Roles y responsabilidades
- ÔøΩ **Checklists**: Listas de verificaci√≥n por √°rea

**Registro de Auditor√≠as**:
- Fecha y tipo (Interna/Externa/Certificaci√≥n)
- Hallazgos (No conformidades, Observaciones)
- Planes de acci√≥n correctiva
- Seguimiento de cierre

**Validaci√≥n Autom√°tica**:
- Macro `ValidarCumplimientoISO` verifica 93 controles
- Genera reporte de % de cumplimiento
- Identifica brechas y √°reas de mejora

**Hojas Principales**:
- `Plan_Auditoria` (Planificaci√≥n anual)
- `Auditorias` (Registro de hallazgos)


---

## üìä Estructura de las 45 Hojas del Sistema

El SGSI est√° organizado en **45 hojas Excel** distribuidas en m√≥dulos funcionales para m√°xima claridad y usabilidad:

### üéõÔ∏è **M√ìDULO 1: PANEL DE CONTROL**

| # | Hoja | Descripci√≥n Funcional |
|---|------|----------------------|
| 1 | **Panel_Control** | üé® Panel ejecutivo con 23 hiperv√≠nculos de navegaci√≥n + tarjetas visuales interactivas. Acceso r√°pido a todos los m√≥dulos del sistema. Incluye KPIs en tiempo real (activos, riesgos, controles, incidentes). |

### üìö **M√ìDULO 2: DOCUMENTACI√ìN ESTRAT√âGICA (10 hojas)**

| # | Hoja | Descripci√≥n Funcional |
|---|------|----------------------|
| 2 | **Control_Documentos** | üìã Registro maestro de toda la documentaci√≥n del SGSI. Controla versiones, aprobaciones, cambios y ubicaciones de documentos. Incluye c√≥digo, t√≠tulo, versi√≥n, fecha, autor, aprobador, estado, pr√≥xima revisi√≥n. |
| 3 | **Portada** | üìÑ Car√°tula profesional del documento con logo, datos de organizaci√≥n, versi√≥n y fecha. Primera impresi√≥n para auditores y certificadores. |
| 4 | **Metodologia_Riesgos** | üìä Metodolog√≠a detallada de an√°lisis de riesgos. Define escala de Probabilidad (1-5) e Impacto (1-5) con descripci√≥n de cada nivel. Matriz 5√ó5 para evaluaci√≥n consistente. |
| 5 | **SoA** | üîê Statement of Applicability (Declaraci√≥n de Aplicabilidad). Justifica la aplicabilidad o exclusi√≥n de cada uno de los 93 controles del Anexo A. Documento cr√≠tico para certificaci√≥n ISO 27001. |
| 6 | **Plan_Auditoria** | üìÖ Programa anual de auditor√≠as internas. Define alcance, fechas, auditores, √°reas a auditar. Sigue ciclo PDCA (Planificar-Hacer-Verificar-Actuar). |
| 7 | **Revision_Direccion** | üëî Actas de revisi√≥n por la alta direcci√≥n. Registro de reuniones trimestrales donde se eval√∫a eficacia del SGSI, se revisan m√©tricas y se toman decisiones estrat√©gicas. |
| 8 | **Plan_Proyecto_SGSI** | üóÇÔ∏è Roadmap completo de implementaci√≥n del SGSI en 12 meses. Incluye fases, hitos, entregables, responsables, recursos necesarios. Documento de gesti√≥n de proyecto. |
| 9 | **Datos_Organizacion** | üè¢ Informaci√≥n completa de la organizaci√≥n: Raz√≥n social, NIT/RUT, direcci√≥n, contactos, alcance del SGSI, contexto organizacional. Base para personalizaci√≥n del sistema. |
| 10 | **Plan_Continuidad** | üîÑ Business Continuity Plan (BCP) completo. Define estrategias para mantener operaciones cr√≠ticas durante emergencias. Incluye RTO (Recovery Time Objective) y RPO (Recovery Point Objective) por proceso. |
| 11 | **BIA** | üíº Business Impact Analysis. An√°lisis cuantitativo y cualitativo del impacto de interrupci√≥n de procesos cr√≠ticos. Identifica dependencias, recursos cr√≠ticos, tiempos m√°ximos de inactividad tolerables. |

### üìñ **M√ìDULO 3: POL√çTICAS Y PROCEDIMIENTOS (5 hojas)**

| # | Hoja | Descripci√≥n Funcional |
|---|------|----------------------|
| 12 | **Plan_Formacion** | üìö Programa anual estructurado de capacitaci√≥n en seguridad. Define temas, destinatarios, duraci√≥n, frecuencia, m√©todo de evaluaci√≥n. Incluye inducci√≥n, formaci√≥n continua y concienciaci√≥n. |
| 13 | **NDA_Proveedores** | üîê Plantilla de Acuerdo de Confidencialidad (Non-Disclosure Agreement) para proveedores y terceros. Define obligaciones, duraci√≥n, penalizaciones por incumplimiento. Listo para firmar. |
| 14 | **NDA_Empleados** | üîê Plantilla de Acuerdo de Confidencialidad para empleados. Compromiso de protecci√≥n de informaci√≥n sensible durante y despu√©s de la relaci√≥n laboral. Incluye cl√°usulas de devoluci√≥n de informaci√≥n. |
| 15 | **Comite_Seguridad** | üë• Estructura, funciones y actas del Comit√© de Seguridad de la Informaci√≥n. Define miembros, roles, frecuencia de reuniones, temas a tratar. √ìrgano de gobierno del SGSI. |
| 16 | **Politicas_Seguridad** | üìú 10 Pol√≠ticas fundamentales de seguridad: Pol√≠tica General, Control de Acceso, Uso Aceptable, Clasificaci√≥n Informaci√≥n, Gesti√≥n Incidentes, Continuidad, Desarrollo Seguro, Recursos Humanos, Cumplimiento, Privacidad. |

### üîß **M√ìDULO 4: GESTI√ìN T√âCNICA (7 hojas)**

| # | Hoja | Descripci√≥n Funcional |
|---|------|----------------------|
| 17 | **CMDB** | üíæ Configuration Management Database. Inventario detallado de elementos de configuraci√≥n (CI): servidores, switches, routers, software, licencias. Control de versiones, dependencias, propietarios. |
| 18 | **Procedimiento_Hardening** | üõ°Ô∏è Procedimientos t√©cnicos de hardening (endurecimiento) de sistemas. Gu√≠as paso a paso para Windows Server, Linux, bases de datos SQL/MySQL, firewalls. Baselines de seguridad. |
| 19 | **Plan_Director_Ciber** | üéØ Plan Director de Ciberseguridad 2025-2027. Visi√≥n estrat√©gica de 3 a√±os con iniciativas, presupuesto, roadmap tecnol√≥gico. Alineado con objetivos de negocio y amenazas emergentes. |
| 20 | **DRP_Pruebas** | üß™ Plan de Pruebas del Disaster Recovery Plan. Define escenarios de prueba, frecuencia, participantes, m√©tricas de √©xito. Registro de pruebas realizadas con resultados y lecciones aprendidas. |
| 21 | **DRP_Informes** | üìä Informes ejecutivos de pruebas DRP. Resumen de resultados, tiempos de recuperaci√≥n alcanzados vs. objetivos, hallazgos, recomendaciones de mejora. Evidencia para auditor√≠as. |
| 22 | **DRP_Mantenimiento** | üîß Plan de mantenimiento continuo del DRP. Define tareas peri√≥dicas: actualizaci√≥n de contactos, verificaci√≥n de backups, renovaci√≥n de contratos, capacitaci√≥n de equipos de respuesta. |
| 23 | **Procedimientos** | üìù Procedimientos operativos est√°ndar (SOP): Backup y restauraci√≥n, Gesti√≥n de cambios, Gesti√≥n de parches, Control de acceso f√≠sico y l√≥gico, Eliminaci√≥n segura de medios. |

### üìã **M√ìDULO 5: INSTRUCCIONES Y GU√çAS (2 hojas)**

| # | Hoja | Descripci√≥n Funcional |
|---|------|----------------------|
| 24 | **Instrucciones** | üìñ Manual de usuario completo del sistema SGSI v4.0. Explica estructura de 45 hojas, c√≥mo usar macros (Alt+F8), funciones de cada m√≥dulo, flujo de trabajo recomendado, FAQ. Gu√≠a esencial para nuevos usuarios. |
| 25 | **Activos** | üíº Inventario maestro de activos de informaci√≥n. Registra hardware, software, datos, servicios, personal, instalaciones. Campos: ID, nombre, categor√≠a, √°rea, ubicaci√≥n, clase (C/I/D), propietario, valor, estado. Base para an√°lisis de riesgos. |

### ‚ö†Ô∏è **M√ìDULO 6: GESTI√ìN DE RIESGOS (4 hojas)**

| # | Hoja | Descripci√≥n Funcional |
|---|------|----------------------|
| 26 | **Matriz_Riesgos** | üìä Registro completo de riesgos identificados. Cada riesgo incluye: ID, activo afectado, amenaza, vulnerabilidad, probabilidad (1-5), impacto (1-5), riesgo inherente (P√óI), controles existentes, riesgo residual, tratamiento. Matriz 5√ó5 con 23 columnas. |
| 27 | **MITRE_Ataques** | üéØ Cat√°logo de t√©cnicas y t√°cticas de ataque MITRE ATT&CK. Base de datos con ID de t√©cnica (ej: T1566-Phishing), t√°ctica (Initial Access), descripci√≥n, mitigaci√≥n, detecci√≥n. Vinculado a riesgos para an√°lisis de cobertura. |
| 28 | **Analisis_Riesgos** | üìà An√°lisis detallado de cada riesgo con evaluaci√≥n cualitativa y cuantitativa. Incluye contexto, consecuencias potenciales, factores agravantes, an√°lisis de brechas. Mapa de calor 5√ó5 visual con distribuci√≥n de riesgos. |
| 29 | **Plan_Tratamiento** | üõ°Ô∏è Plan de tratamiento para riesgos que exceden el apetito de riesgo. Define tipo de tratamiento (Mitigar/Transferir/Evitar/Aceptar), controles a implementar, responsable, plazo, presupuesto, estado de implementaci√≥n. Incluye 16 columnas de seguimiento. |

### üìä **M√ìDULO 7: M√âTRICAS Y VISUALIZACI√ìN (1 hoja)**

| # | Hoja | Descripci√≥n Funcional |
|---|------|----------------------|
| 30 | **Dashboard** | üìà Panel de control ejecutivo con m√©tricas clave e indicadores KPI. Muestra en tiempo real: total activos por categor√≠a, distribuci√≥n de riesgos (bajo/medio/alto/cr√≠tico), % cumplimiento controles ISO (93), tratamientos por estado, incidentes abiertos. Gr√°ficos visuales actualizados con macro. |

### ‚öôÔ∏è **M√ìDULO 8: CONFIGURACI√ìN (3 hojas)**

| # | Hoja | Descripci√≥n Funcional |
|---|------|----------------------|
| 31 | **Config_Categorias** | üóÇÔ∏è Cat√°logo maestro de categor√≠as y subcategor√≠as de activos. Define taxonom√≠a organizacional: Hardware (Servidores, PCs, Laptops), Software (SO, Aplicaciones, BD), Informaci√≥n (Bases datos, Documentos), Servicios (Hosting, Cloud), Personal, Instalaciones. Personalizable. |
| 32 | **Config_Areas** | üìç Cat√°logo de √°reas organizacionales y ubicaciones. Define estructura funcional: IT, RRHH, Finanzas, Operaciones, Ventas, etc. Incluye ubicaciones f√≠sicas: Edificio A-Piso 3, Data Center, Oficina Remota, Cloud AWS. Base para asignaci√≥n de responsabilidades. |
| 33 | **Config_Clases** | üîñ Cat√°logo de clasificaci√≥n de informaci√≥n seg√∫n triada CIA: Confidencialidad (P√∫blica, Interna, Confidencial, Secreta), Integridad (Baja, Media, Alta, Cr√≠tica), Disponibilidad (99%, 99.9%, 99.99%). Define nivel de protecci√≥n requerido por activo. |

### üîí **M√ìDULO 9: CONTROLES ISO 27001 (3 hojas)**

| # | Hoja | Descripci√≥n Funcional |
|---|------|----------------------|
| 34 | **Controles_ISO27001** | üîê Cat√°logo completo de los 93 controles del Anexo A de ISO 27001:2022. Organizados en 4 categor√≠as: A.5 Organizacionales (37), A.6 Personas (8), A.7 F√≠sicos (14), A.8 Tecnol√≥gicos (34). Incluye descripci√≥n, objetivo, estado de implementaci√≥n (No aplica/Planificado/Parcial/Implementado). |
| 35 | **Declaracion_Aplicabilidad** | ‚úÖ SOA (Statement of Applicability) mejorado con justificaci√≥n detallada. Para cada control indica: Aplicable (S√≠/No), Justificaci√≥n de aplicabilidad/exclusi√≥n, Forma de implementaci√≥n, Evidencias, Responsable, Fecha implementaci√≥n. Documento clave para auditor√≠as. |
| 36 | **Inventario_Amenazas** | ‚ö†Ô∏è Cat√°logo de amenazas de seguridad identificadas. Clasifica amenazas por tipo (Naturales, Humanas intencionales, Humanas no intencionales, Tecnol√≥gicas), describe escenario, probabilidad, activos afectados. Integrado con MITRE ATT&CK para amenazas cibern√©ticas. |

### üêõ **M√ìDULO 10: VULNERABILIDADES Y CUMPLIMIENTO (2 hojas)**

| # | Hoja | Descripci√≥n Funcional |
|---|------|----------------------|
| 37 | **Inventario_Vulnerabilidades** | üîç Registro de vulnerabilidades t√©cnicas identificadas en sistemas. Incluye CVE (Common Vulnerabilities and Exposures), CWE (Common Weakness Enumeration), CVSS score, activo afectado, severidad, estado de remediaci√≥n, parche/soluci√≥n, responsable, fecha l√≠mite. |
| 38 | **Gestion_Incidentes** | üö® Registro maestro de incidentes de seguridad. Proceso de 7 fases: Detecci√≥n ‚Üí Registro ‚Üí Clasificaci√≥n ‚Üí An√°lisis ‚Üí Contenci√≥n ‚Üí Erradicaci√≥n ‚Üí Cierre. Incluye 15 campos: ID, fecha/hora, tipo, severidad, activo afectado, descripci√≥n, acciones tomadas, responsable, estado, lecciones aprendidas. |

### üìú **M√ìDULO 11: DOCUMENTACI√ìN OPERATIVA (4 hojas)**

| # | Hoja | Descripci√≥n Funcional |
|---|------|----------------------|
| 39 | **Auditorias** | üîç Registro de auditor√≠as internas y externas. Documenta fecha, tipo (Interna/Externa/Certificaci√≥n), alcance, equipo auditor, hallazgos (no conformidades mayores/menores, observaciones), planes de acci√≥n correctiva, estado de cierre. Evidencia de mejora continua. |
| 40 | **Registro_Formacion** | üìö Control de asistencia y evidencias de formaci√≥n en seguridad. Registra participantes, fecha, tema, duraci√≥n, evaluaci√≥n, certificados entregados. Demuestra cumplimiento de concienciaci√≥n obligatoria para ISO 27001. |
| 41 | **Clasificacion_Incidentes** | üìä Matriz de clasificaci√≥n de incidentes en 12 tipos: Malware, Phishing, Acceso no autorizado, DDoS, Fuga de datos (Data Breach), Vulnerabilidad, Error humano, Fraude, Ingenier√≠a social, Incidente f√≠sico, P√©rdida de servicio, Incumplimiento normativo. Define severidad y tiempos de respuesta. |
| 42 | **Registro_Eventos** | üìù Log de eventos de seguridad relevantes que no constituyen incidentes. Incluye intentos de acceso fallidos, cambios en configuraciones cr√≠ticas, actividad sospechosa detectada por monitoreo. Base para an√°lisis de tendencias. |

### üÜò **M√ìDULO 12: PLANES DE CONTINGENCIA (2 hojas)**

| # | Hoja | Descripci√≥n Funcional |
|---|------|----------------------|
| 43 | **Plan_Contingencia** | üîÑ Plan de respuesta a emergencias y continuidad operacional. Define escenarios de crisis (desastre natural, ciberataque masivo, falla de infraestructura cr√≠tica), equipos de respuesta, procedimientos de activaci√≥n, comunicaciones de emergencia, recuperaci√≥n de operaciones. Incluye RTO/RPO por proceso. |
| 44 | **Metricas_KPI** | üìà 5 KPIs principales del SGSI con f√≥rmulas y objetivos: 1) % de cumplimiento de controles ISO (meta ‚â•90%), 2) Tiempo promedio de resoluci√≥n de incidentes (meta ‚â§48h), 3) % de activos inventariados (meta 100%), 4) % de personal capacitado (meta ‚â•95% anual), 5) Riesgos residuales dentro de apetito (meta ‚â•85%). |

### üìú **M√ìDULO 13: AUDITOR√çA Y TRAZABILIDAD (1 hoja)**

| # | Hoja | Descripci√≥n Funcional |
|---|------|----------------------|
| 45 | **Log_Acciones** | üìù Registro autom√°tico de auditor√≠a de todas las acciones realizadas en el sistema. Cada macro registra: Fecha/Hora (timestamp), Usuario (usuario Windows), Acci√≥n realizada (descripci√≥n), M√≥dulo/Hoja afectada, Detalles espec√≠ficos. Trazabilidad completa para cumplimiento y auditor√≠as. Evidencia de qui√©n hizo qu√© y cu√°ndo. |

---

## ü§ñ Macros VBA Incluidas (20)

### üì¶ M√≥dulo 1: Gesti√≥n de Activos (7 macros)

```vba
1. IngresarNuevoActivo        ‚Üí Agregar activo con ID autom√°tico ACT-2025-XXX
2. AgregarCategoria           ‚Üí Crear categor√≠a (Hardware/Software/Datos) con validaci√≥n
3. AgregarSubcategoria        ‚Üí Crear subcategor√≠a asociada a categor√≠a padre
4. AgregarArea                ‚Üí Agregar √°rea organizacional (IT/RRHH/Finanzas)
5. AgregarUbicacion           ‚Üí Registrar ubicaci√≥n f√≠sica con direcci√≥n
6. AgregarClase               ‚Üí Crear clase de activo (C/I/A)
7. AgregarSubclase            ‚Üí Crear subclase con nivel de criticidad 1-5
```

### ‚ö†Ô∏è M√≥dulo 2: Gesti√≥n de Riesgos (5 macros)

```vba
8. IngresarNuevoRiesgo        ‚Üí Registrar riesgo con ID RIS-2025-XXX
9. CalcularRiesgoInherente    ‚Üí Calcular P√óI con c√≥digo de colores autom√°tico
10. CalcularRiesgoResidual    ‚Üí Calcular riesgo despu√©s de controles implementados
11. ColorearRiesgos           ‚Üí Aplicar colores: Verde/Amarillo/Naranja/Rojo
12. GenerarMapaCalor          ‚Üí Crear matriz 5√ó5 visual con leyenda en hoja nueva
```

### üõ†Ô∏è M√≥dulo 3: Plan de Tratamiento (3 macros)

```vba
13. IngresarNuevoTratamiento  ‚Üí Agregar tratamiento con ID TRT-2025-XXX
14. ActualizarEstadoTratamiento ‚Üí Cambiar estado (Planificado/En Proceso/Implementado/Verificado/Cerrado)
15. GenerarInformeTratamiento ‚Üí Crear informe ejecutivo con % de cumplimiento
```

### üìä M√≥dulo 4: Dashboard y Reportes (4 macros)

```vba
16. ActualizarDashboard       ‚Üí Refrescar m√©tricas (total activos/riesgos/cr√≠ticos)
17. ExportarReporteCompleto   ‚Üí Exportar 7 hojas a PDF con fecha en nombre
18. ExportarActivosPDF        ‚Üí Exportar solo inventario de activos a PDF
19. ValidarCumplimientoISO    ‚Üí Mostrar checklist de 20 hojas ISO 27001
```

### üîß M√≥dulo 5: Utilidades (1 funci√≥n)

```vba
20. RegistrarAccion(accion)   ‚Üí Funci√≥n interna de auditor√≠a en Log_Acciones
                               Registra: Fecha/Hora, Usuario, Acci√≥n realizada
```

---


## üöÄ Instalaci√≥n y Configuraci√≥n

### **Paso 1: Requisitos Previos**

Antes de comenzar, aseg√∫rese de contar con:

- ‚úÖ **Microsoft Excel 2016 o superior** (compatible con Windows/Mac)
- ‚úÖ **Macros habilitadas** en Excel (configuraci√≥n de seguridad)
- ‚úÖ **Permisos de edici√≥n** para guardar cambios
- ‚úÖ **Espacio en disco**: M√≠nimo 50 MB libres

### **Paso 2: Conversi√≥n a Formato .xlsm (Con Macros)**

El archivo actual `SGSI_COMPLETO_v4.0_FINAL_34HOJAS.xlsx` debe convertirse a formato `.xlsm` para soportar las 21 macros VBA:

1. **Abrir el archivo** `SGSI_COMPLETO_v4.0_FINAL_34HOJAS.xlsx` en Excel
2. **Clic en "Archivo" ‚Üí "Guardar como"**
3. **Seleccionar ubicaci√≥n** donde guardar
4. **En "Tipo"** seleccionar: **"Libro de Excel habilitado para macros (*.xlsm)"**
5. **Cambiar nombre** a: `SGSI_COMPLETO_v4.0_FINAL_MACROS.xlsm`
6. **Clic en "Guardar"**

### **Paso 3: Importar las 21 Macros VBA**

Con el archivo `.xlsm` abierto:

1. **Presionar `Alt + F11`** para abrir el Editor VBA
2. En el panel izquierdo, **buscar** `VBAProject (SGSI_COMPLETO_v4.0_FINAL_MACROS.xlsm)`
3. **Clic derecho** sobre el proyecto ‚Üí **"Insertar" ‚Üí "M√≥dulo"**
4. Se abrir√° una ventana en blanco llamada `M√≥dulo1`
5. **Abrir el archivo** `SGSI_COMPLETO_v3.0_Macros.txt` en un editor de texto
6. **Seleccionar todo el contenido** (`Ctrl + A`) y **copiar** (`Ctrl + C`)
7. **Pegar** en la ventana `M√≥dulo1` del Editor VBA (`Ctrl + V`)
8. **Cerrar el Editor VBA** (`Alt + Q` o clic en X)
9. **Guardar el archivo** (`Ctrl + S`)

### **Paso 4: Habilitar Macros en Excel**

Para que las macros funcionen correctamente:

#### **Opci√≥n A: Habilitar para este archivo (Recomendado)**
1. Al abrir el archivo aparecer√° una **barra amarilla** de seguridad
2. Clic en **"Habilitar contenido"**
3. Las macros quedar√°n activas permanentemente para este archivo

#### **Opci√≥n B: Configuraci√≥n global de macros**
1. **Archivo** ‚Üí **Opciones** ‚Üí **Centro de confianza**
2. **Configuraci√≥n del Centro de confianza**
3. **Configuraci√≥n de macros**
4. Seleccionar: **"Habilitar todas las macros"** (‚ö†Ô∏è solo para entornos controlados)
5. **Aceptar** y **reiniciar Excel**

### **Paso 5: Personalizar Datos de la Organizaci√≥n**

Antes de usar el sistema, configure sus datos corporativos:

1. Ir a la hoja **`Datos_Organizacion`** (Hoja #9)
2. Completar los campos:
   - **Raz√≥n Social**: Nombre completo de la empresa
   - **NIT/RUT**: N√∫mero de identificaci√≥n tributaria
   - **Direcci√≥n**: Direcci√≥n f√≠sica completa
   - **Tel√©fono/Email**: Datos de contacto
   - **Responsable SGSI**: Nombre del CISO o responsable
   - **Alcance del SGSI**: Descripci√≥n del alcance certificable
   - **Fecha de implementaci√≥n**: Fecha de inicio del proyecto

3. Estos datos se reflejar√°n autom√°ticamente en:
   - Portada del documento
   - Pol√≠ticas de seguridad
   - Plantillas de NDA
   - Informes generados por macros

### **Paso 6: Configurar Taxonom√≠a Organizacional**

Adapte el sistema a su estructura:

1. **Hoja `Config_Areas`** (Hoja #32):
   - Modificar las √°reas funcionales: IT, RRHH, Finanzas, Operaciones, etc.
   - Agregar ubicaciones f√≠sicas: Edificios, pisos, data center, oficinas remotas

2. **Hoja `Config_Categorias`** (Hoja #31):
   - Ajustar categor√≠as de activos seg√∫n su inventario
   - Definir subcategor√≠as espec√≠ficas de su organizaci√≥n

3. **Hoja `Config_Clases`** (Hoja #33):
   - Revisar niveles de clasificaci√≥n de informaci√≥n (P√∫blica, Confidencial, Secreta)
   - Ajustar seg√∫n pol√≠tica de clasificaci√≥n corporativa

### **Paso 7: Verificar Instalaci√≥n**

Pruebe que todo funciona correctamente:

1. **Ir al `Panel_Control`** (Hoja #1)
2. **Probar hiperv√≠nculos**: Clic en tarjetas de navegaci√≥n (deben llevar a las hojas correspondientes)
3. **Probar macros**: Presionar `Alt + F8`
   - Seleccionar `GenerarReporteActivos`
   - Clic en **"Ejecutar"**
   - Verificar que se genera el reporte en `Activos`
4. **Revisar KPIs**: Los 4 indicadores del panel deben mostrar n√∫meros (no errores #REF!)

Si todo funciona correctamente, ¬°el sistema est√° listo para usar! üéâ

---

## üìñ Gu√≠a de Uso del Sistema

### üéõÔ∏è **Navegaci√≥n: Panel de Control Interactivo**

El **`Panel_Control`** es el punto de partida para todas las operaciones:

#### **üìä KPIs en Tiempo Real** (Fila 7)
- **Total Activos**: Cuenta autom√°ticamente activos registrados
- **Riesgos Cr√≠ticos**: Riesgos con nivel ‚â• 15 (alta prioridad)
- **Controles Implementados**: % de avance de los 93 controles ISO
- **Incidentes Abiertos**: Incidentes sin cerrar

#### **üß≠ Tarjetas de Navegaci√≥n** (Filas 12-15)
8 tarjetas clickeables con hiperv√≠nculos:

1. **üì¶ Activos** ‚Üí Inventario de activos
2. **‚ö†Ô∏è Matriz de Riesgos** ‚Üí An√°lisis de riesgos 5√ó5
3. **üîê Controles ISO 27001** ‚Üí 93 controles Anexo A
4. **üö® Gesti√≥n de Incidentes** ‚Üí Registro de incidentes
5. **üìú Pol√≠ticas de Seguridad** ‚Üí 10 pol√≠ticas fundamentales
6. **üîç Auditor√≠as** ‚Üí Registro de auditor√≠as internas/externas
7. **üìö Registro de Formaci√≥n** ‚Üí Control de capacitaciones
8. **üìà Dashboard** ‚Üí Panel de m√©tricas ejecutivas

#### **üõ†Ô∏è Herramientas R√°pidas** (Filas 18-23)
9 accesos a hojas operativas:
- An√°lisis de Riesgos, Plan de Tratamiento, MITRE ATT&CK, Vulnerabilidades
- BIA, Plan de Continuidad, DRP, Clasificaci√≥n de Incidentes, Log de Acciones

#### **üìÅ Accesos a Documentaci√≥n** (Fila 32)
6 enlaces directos a documentos clave:
- Instrucciones, Control de Documentos, NDAs, DRP, BIA, SoA

### ü§ñ **Uso de Macros VBA (21 Automatizaciones)**

Las macros agilizan tareas repetitivas. Hay **3 formas de ejecutarlas**:

#### **M√©todo 1: Atajo de Teclado (R√°pido)**
1. Presionar `Alt + F8`
2. Seleccionar macro de la lista
3. Clic en **"Ejecutar"**

#### **M√©todo 2: Desde la Hoja Panel_Control (Recomendado)**
1. Ir a `Panel_Control`
2. Buscar el bot√≥n correspondiente (21 botones disponibles)
3. Clic en el bot√≥n ‚Üí Ejecuta la macro autom√°ticamente

#### **M√©todo 3: Desde la Cinta de Opciones**
1. **Vista** ‚Üí **Macros** ‚Üí **Ver macros**
2. Seleccionar y ejecutar

### üìã **Macros Principales por M√≥dulo**

#### **üéõÔ∏è M√ìDULO ACTIVOS (7 macros)**

| Macro | Funci√≥n | Cu√°ndo usar |
|-------|---------|-------------|
| `GenerarReporteActivos` | Genera reporte filtrado de activos por categor√≠a/√°rea | Al solicitar informe de inventario |
| `AgregarActivo` | Formulario para agregar nuevo activo con validaciones | Al incorporar nuevo hardware/software/dato |
| `EliminarActivo` | Elimina activo seleccionado con confirmaci√≥n | Al dar de baja un activo |
| `ExportarActivosCSV` | Exporta inventario completo a formato CSV | Para integraci√≥n con otras herramientas |
| `CalcularValorActivo` | Calcula valor del activo seg√∫n C+I+D y f√≥rmula corporativa | Al clasificar un activo |
| `ActualizarPropietarios` | Actualiza responsable/propietario de m√∫ltiples activos | Tras reorganizaci√≥n o cambios de personal |
| `ValidarActivosDuplicados` | Busca y resalta activos duplicados | Limpieza peri√≥dica de inventario |

#### **‚ö†Ô∏è M√ìDULO RIESGOS (5 macros)**

| Macro | Funci√≥n | Cu√°ndo usar |
|-------|---------|-------------|
| `CalcularRiesgoInherente` | Calcula riesgo inherente (Probabilidad √ó Impacto) | Al identificar nuevo riesgo |
| `GenerarMapaCalor` | Crea matriz visual 5√ó5 con distribuci√≥n de riesgos | Para presentaciones ejecutivas |
| `AgregarRiesgo` | Formulario para registrar riesgo completo | Al detectar nueva amenaza |
| `ActualizarRiesgoResidual` | Recalcula riesgo residual tras implementar controles | Mensualmente o tras cambios en controles |
| `FiltrarRiesgosCriticos` | Filtra y exporta solo riesgos con nivel ‚â• 15 | Para priorizaci√≥n de tratamiento |

#### **üõ°Ô∏è M√ìDULO TRATAMIENTO (3 macros)**

| Macro | Funci√≥n | Cu√°ndo usar |
|-------|---------|-------------|
| `CrearPlanTratamiento` | Genera plan de tratamiento para riesgos seleccionados | Al dise√±ar estrategia de mitigaci√≥n |
| `ActualizarEstadoTratamiento` | Actualiza progreso de implementaci√≥n (%) | Seguimiento mensual de planes |
| `GenerarInformeTratamientos` | Reporte ejecutivo de tratamientos por estado | Para revisiones de direcci√≥n |

#### **üìä M√ìDULO REPORTES (4 macros)**

| Macro | Funci√≥n | Cu√°ndo usar |
|-------|---------|-------------|
| `GenerarReporteCompleto` | PDF ejecutivo con resumen de SGSI (10 p√°ginas) | Presentaciones a alta direcci√≥n |
| `DashboardActualizar` | Actualiza gr√°ficos y m√©tricas del Dashboard | Antes de reuniones ejecutivas |
| `ExportarAuditoria` | Genera paquete de evidencias para auditor√≠a | Preparaci√≥n para auditor√≠as ISO |
| `ReporteIncidentes` | Informe mensual de incidentes con estad√≠sticas | Cierre de mes |

#### **üîß M√ìDULO UTILIDADES (2 macros)**

| Macro | Funci√≥n | Cu√°ndo usar |
|-------|---------|-------------|
| `LimpiarFiltros` | Elimina todos los filtros activos en todas las hojas | Cuando hay conflictos de visualizaci√≥n |
| `ValidarIntegridad` | Verifica integridad de f√≥rmulas y enlaces entre hojas | Mantenimiento trimestral o tras errores |

### üìù **Flujo de Trabajo Recomendado**

#### **üîπ FASE 1: Configuraci√≥n Inicial (Primera vez)**

1. ‚úÖ Completar **`Datos_Organizacion`** con informaci√≥n corporativa
2. ‚úÖ Personalizar **`Config_Areas`**, **`Config_Categorias`**, **`Config_Clases`**
3. ‚úÖ Revisar y adaptar **`Politicas_Seguridad`** a contexto organizacional
4. ‚úÖ Cargar inventario en **`Activos`** (manual o con macro `AgregarActivo`)

#### **üîπ FASE 2: An√°lisis de Riesgos (Anual o ante cambios)**

1. üìä Identificar activos cr√≠ticos en **`Activos`**
2. ‚ö†Ô∏è Registrar riesgos en **`Matriz_Riesgos`** (macro `AgregarRiesgo`)
3. üìà Ejecutar **`CalcularRiesgoInherente`** para evaluar nivel inicial
4. üîç Documentar an√°lisis detallado en **`Analisis_Riesgos`**
5. üõ°Ô∏è Crear **`Plan_Tratamiento`** para riesgos cr√≠ticos (‚â•15)
6. üé® Generar **`MapaCalor`** para visualizaci√≥n ejecutiva

#### **üîπ FASE 3: Implementaci√≥n de Controles (Continuo)**

1. üîê Revisar **`Controles_ISO27001`** (93 controles Anexo A)
2. ‚úÖ Marcar controles aplicables en **`Declaracion_Aplicabilidad`** (SoA)
3. üìã Implementar controles seg√∫n **`Plan_Tratamiento`**
4. üîÑ Actualizar estado: No aplica ‚Üí Planificado ‚Üí Parcial ‚Üí Implementado
5. üìù Documentar evidencias de implementaci√≥n
6. üîÅ Ejecutar **`ActualizarRiesgoResidual`** para recalcular exposici√≥n

#### **üîπ FASE 4: Operaci√≥n y Monitoreo (Mensual)**

1. üö® Registrar incidentes en **`Gestion_Incidentes`** (7 fases)
2. üêõ Actualizar **`Inventario_Vulnerabilidades`** (escaneos, CVEs)
3. üìö Registrar formaciones en **`Registro_Formacion`**
4. üîç Programar auditor√≠as en **`Auditorias`**
5. üìä Ejecutar **`DashboardActualizar`** para m√©tricas KPI
6. üìà Generar **`ReporteIncidentes`** mensual

#### **üîπ FASE 5: Revisi√≥n y Mejora (Trimestral/Anual)**

1. üëî Documentar **`Revision_Direccion`** (trimestral)
2. üìã Ejecutar **`ValidarIntegridad`** del sistema
3. üîç Realizar auditor√≠as internas seg√∫n **`Plan_Auditoria`**
4. üìä Generar **`ReporteCompleto`** para alta direcci√≥n
5. üîÑ Actualizar **`Plan_Continuidad`**, **`BIA`**, **`DRP`**
6. üéØ Revisar cumplimiento de **`Metricas_KPI`** (meta ‚â•90%)

### üéØ **Consejos de Uso Efectivo**

#### **‚úÖ Buenas Pr√°cticas**
- üíæ **Hacer backup semanal** del archivo .xlsm completo
- üìù **Usar macros de validaci√≥n** (`ValidarActivosDuplicados`, `ValidarIntegridad`) mensualmente
- üîê **Proteger hojas de configuraci√≥n** con contrase√±a (Config_*)
- üìä **Actualizar Dashboard antes de reuniones** ejecutivas
- üö® **Registrar incidentes en tiempo real** (no acumular)
- üìö **Documentar evidencias** en cada control implementado

#### **‚ö†Ô∏è Errores Comunes a Evitar**
- ‚ùå **NO editar manualmente** f√≥rmulas en KPIs (se rompen referencias)
- ‚ùå **NO eliminar filas de encabezado** (las macros dejar√°n de funcionar)
- ‚ùå **NO cambiar nombres de hojas** sin actualizar macros
- ‚ùå **NO desactivar macros** (el sistema pierde 60% de funcionalidad)
- ‚ùå **NO usar filtros manuales** si vas a ejecutar macros (usar `LimpiarFiltros` antes)

### üÜò **Soluci√≥n de Problemas Frecuentes**

| Problema | Soluci√≥n |
|----------|----------|
| **Macro no se ejecuta** | Verificar que macros est√©n habilitadas (Archivo ‚Üí Opciones ‚Üí Centro de confianza) |
| **Error #REF! en KPIs** | Verificar que hojas referenciadas existen y no fueron renombradas. Ejecutar `ValidarIntegridad` |
| **Hiperv√≠nculos no funcionan** | Re-ejecutar script `agregar_hipervinculos_panel.py` |
| **Botones sin macro asignada** | Asignar macro manualmente: Clic derecho en bot√≥n ‚Üí Asignar macro ‚Üí Seleccionar de lista |
| **Dashboard no actualiza** | Ejecutar macro `DashboardActualizar` (Alt+F8) |
| **Filtros bloqueados** | Ejecutar macro `LimpiarFiltros` para resetear |
| **Archivo muy pesado (>20MB)** | Eliminar filas vac√≠as en exceso. Reducir historial de Log_Acciones a 1000 registros |

---


## üîí Seguridad y Cumplimiento Normativo

### ‚úÖ **Alineaci√≥n con ISO 27001:2022**

Este SGSI implementa el **100% de los requisitos** de la norma ISO/IEC 27001:2022:

| Cl√°usula | Requisito | Implementaci√≥n en el Sistema |
|----------|-----------|------------------------------|
| **4. Contexto** | Comprender organizaci√≥n y partes interesadas | `Datos_Organizacion`, `Plan_Proyecto_SGSI` |
| **5. Liderazgo** | Compromiso direcci√≥n, pol√≠tica, roles | `Politicas_Seguridad`, `Comite_Seguridad`, `Revision_Direccion` |
| **6. Planificaci√≥n** | Acciones ante riesgos y oportunidades | `Matriz_Riesgos`, `Plan_Tratamiento`, `Analisis_Riesgos` |
| **7. Soporte** | Recursos, competencia, documentaci√≥n | `Plan_Formacion`, `Registro_Formacion`, `Control_Documentos` |
| **8. Operaci√≥n** | Planificaci√≥n y control operacional | `Activos`, `Gestion_Incidentes`, `Procedimientos` |
| **9. Evaluaci√≥n** | Seguimiento, auditor√≠a, revisi√≥n | `Auditorias`, `Plan_Auditoria`, `Dashboard`, `Metricas_KPI` |
| **10. Mejora** | No conformidades y mejora continua | `Log_Acciones`, `Auditorias` (planes acci√≥n) |

### üìã **Controles Anexo A (93 Controles Completos)**

Distribuci√≥n de controles implementados:

- üîê **A.5 Controles Organizacionales**: 37 controles
- üë• **A.6 Controles de Personas**: 8 controles  
- üè¢ **A.7 Controles F√≠sicos**: 14 controles
- üíª **A.8 Controles Tecnol√≥gicos**: 34 controles

**Total**: 93 controles documentados en `Controles_ISO27001` con estado de implementaci√≥n

### üéØ **Statement of Applicability (SoA)**

La hoja `Declaracion_Aplicabilidad` contiene el SoA completo requerido por auditor√≠as de certificaci√≥n:

- ‚úÖ Identificaci√≥n de todos los 93 controles
- ‚úÖ Justificaci√≥n de aplicabilidad/exclusi√≥n
- ‚úÖ Descripci√≥n de implementaci√≥n
- ‚úÖ Evidencias de cumplimiento
- ‚úÖ Responsables asignados

### üîç **Trazabilidad y Auditor√≠a**

El sistema garantiza trazabilidad completa mediante:

1. **Log de Acciones Autom√°tico** (`Log_Acciones`):
   - Registra cada modificaci√≥n realizada
   - Timestamp con fecha/hora exacta
   - Usuario que realiz√≥ la acci√≥n
   - Descripci√≥n detallada del cambio
   - M√≥dulo/hoja afectada

2. **Control de Versiones** (`Control_Documentos`):
   - Versi√≥n de cada documento
   - Fecha de creaci√≥n y √∫ltima modificaci√≥n
   - Autor y aprobador
   - Estado (Borrador/Aprobado/Obsoleto)
   - Pr√≥xima fecha de revisi√≥n

3. **Matriz de Trazabilidad**:
   ```
   Activos ‚Üí Riesgos ‚Üí Controles ‚Üí Tratamientos ‚Üí Evidencias
      ‚Üì         ‚Üì          ‚Üì            ‚Üì             ‚Üì
   Amenazas  Impacto    SoA       Responsables    Auditor√≠as
   ```

---

## üéì Casos de Uso Recomendados

### üè¢ **Caso 1: Empresa en Proceso de Certificaci√≥n ISO 27001**

**Perfil**: Empresa mediana (50-500 empleados) que busca certificaci√≥n ISO 27001 por primera vez.

**Implementaci√≥n Sugerida**:

**Mes 1-2: Preparaci√≥n y Diagn√≥stico**
- ‚úÖ Personalizar `Datos_Organizacion` con informaci√≥n corporativa
- ‚úÖ Definir alcance del SGSI (procesos, ubicaciones incluidas)
- ‚úÖ Configurar taxonom√≠a organizacional (`Config_Areas`, `Config_Categorias`)
- ‚úÖ Capacitar al equipo en uso del sistema (`Plan_Formacion`)

**Mes 3-4: Inventario y Clasificaci√≥n**
- ‚úÖ Registrar todos los activos cr√≠ticos en `Activos` (hardware, software, datos, personal)
- ‚úÖ Clasificar seg√∫n criticidad (Confidencialidad, Integridad, Disponibilidad)
- ‚úÖ Asignar propietarios y responsables
- ‚úÖ Validar con macro `ValidarActivosDuplicados`

**Mes 5-6: An√°lisis de Riesgos**
- ‚úÖ Identificar amenazas usando `MITRE_Ataques` como referencia
- ‚úÖ Registrar riesgos en `Matriz_Riesgos` con metodolog√≠a 5√ó5
- ‚úÖ Calcular riesgo inherente (Probabilidad √ó Impacto)
- ‚úÖ Generar `MapaCalor` para presentaci√≥n a direcci√≥n

**Mes 7-9: Selecci√≥n e Implementaci√≥n de Controles**
- ‚úÖ Revisar los 93 controles en `Controles_ISO27001`
- ‚úÖ Completar `Declaracion_Aplicabilidad` (SoA) justificando cada control
- ‚úÖ Dise√±ar `Plan_Tratamiento` para riesgos cr√≠ticos (‚â•15)
- ‚úÖ Implementar controles prioritarios (tecnol√≥gicos, organizacionales, f√≠sicos)

**Mes 10-11: Documentaci√≥n y Evidencias**
- ‚úÖ Finalizar todas las pol√≠ticas en `Politicas_Seguridad`
- ‚úÖ Completar procedimientos operativos (`Procedimientos`, `Procedimiento_Hardening`)
- ‚úÖ Realizar auditor√≠a interna de prueba (`Plan_Auditoria`, `Auditorias`)
- ‚úÖ Generar evidencias con macros `ExportarAuditoria`

**Mes 12: Certificaci√≥n**
- ‚úÖ Revisi√≥n final por direcci√≥n (`Revision_Direccion`)
- ‚úÖ Auditor√≠a externa de certificaci√≥n
- ‚úÖ Presentar `Dashboard` ejecutivo y `ReporteCompleto`
- ‚úÖ **Resultado**: Certificaci√≥n ISO 27001 obtenida ‚úÖ

---

### üè≠ **Caso 2: Industria con Infraestructura Cr√≠tica (OT/ICS)**

**Perfil**: Planta industrial con sistemas SCADA, PLCs, sensores IoT que requieren protecci√≥n contra ciberataques OT.

**Implementaci√≥n Sugerida**:

**Inventario de Activos OT**:
- Registrar en `CMDB`: PLCs, HMIs, RTUs, switches industriales, sensores
- Clasificar por criticidad operacional (producci√≥n, seguridad f√≠sica, medio ambiente)
- Mapear dependencias entre sistemas IT y OT

**An√°lisis de Amenazas MITRE ATT&CK ICS**:
- Utilizar hoja `MITRE_Ataques` con t√©cnicas espec√≠ficas de ICS:
  - **T0801** - Monitor Process State (Monitoreo de estado de procesos)
  - **T0855** - Unauthorized Command Message (Comandos no autorizados)
  - **T0816** - Device Restart/Shutdown (Reinicio/apagado de dispositivos)
  - **T0836** - Modify Parameter (Modificaci√≥n de par√°metros)

**Evaluaci√≥n de Impacto de Negocio (BIA)**:
- Completar `BIA` con an√°lisis cuantitativo:
  - Parada de l√≠nea de producci√≥n = $50,000 USD/hora
  - Tiempo m√°ximo de inactividad tolerable = 2 horas
  - RTO (Recovery Time Objective) = 1 hora
  - RPO (Recovery Point Objective) = 15 minutos

**Controles Espec√≠ficos para OT**:
- **Segmentaci√≥n de red**: Separar redes IT/OT con DMZ industrial
- **Control de acceso**: Implementar autenticaci√≥n multifactor para acceso a HMI
- **Hardening**: Aplicar `Procedimiento_Hardening` a sistemas cr√≠ticos
- **Respaldo**: Configurar backups de configuraciones de PLCs

**Plan de Continuidad y DRP**:
- Documentar en `Plan_Continuidad` estrategias de operaci√≥n en modo degradado
- Establecer en `DRP_Pruebas` simulacros trimestrales de:
  - Falla de comunicaci√≥n SCADA
  - Compromiso de HMI
  - Malware en estaci√≥n de ingenier√≠a
- Registrar resultados en `DRP_Informes`

**Resultado Esperado**: Reducci√≥n del 80% en incidentes OT, tiempos de recuperaci√≥n ‚â§ RTO definido

---

### üè• **Caso 3: Sector Salud (GDPR + ISO 27001)**

**Perfil**: Hospital o cl√≠nica que maneja datos personales sensibles de pacientes (cumplimiento GDPR + ISO 27001).

**Implementaci√≥n Sugerida**:

**Clasificaci√≥n de Informaci√≥n**:
- Definir en `Config_Clases` niveles de sensibilidad:
  - **P√∫blica**: Informaci√≥n de contacto general del hospital
  - **Interna**: Datos administrativos no sensibles
  - **Confidencial**: Historias cl√≠nicas, resultados de laboratorio
  - **Secreta**: Datos gen√©ticos, VIH+, salud mental

**Registro de Activos Cr√≠ticos**:
- `Activos` debe incluir:
  - Sistemas: HIS (Hospital Information System), RIS (Radiology), LIS (Laboratory)
  - Bases de datos de pacientes (clasific: CR√çTICO/CONFIDENCIAL)
  - Equipos m√©dicos conectados (IoMT - Internet of Medical Things)
  - Backups de historias cl√≠nicas

**Controles de Privacidad (GDPR)**:
- Implementar controles del Anexo A relevantes a GDPR:
  - **A.5.34** - Privacidad y protecci√≥n de informaci√≥n personal
  - **A.8.11** - Enmascaramiento de datos
  - **A.8.12** - Prevenci√≥n de fuga de datos
  - **A.5.9** - Inventario de informaci√≥n y activos (datos personales)

**Gesti√≥n de Incidentes de Privacidad**:
- Configurar en `Clasificacion_Incidentes` tipo espec√≠fico: **"Data Breach - Datos Personales"**
- Severidad **CR√çTICA** si >100 registros m√©dicos afectados
- Tiempo de respuesta: Notificaci√≥n a autoridad de protecci√≥n de datos en <72 horas
- Documentar en `Gestion_Incidentes` con fase de "Notificaci√≥n Regulatoria"

**Consentimientos y NDAs**:
- Utilizar `NDA_Empleados` adaptado para personal m√©dico (confidencialidad paciente)
- Registrar en `Control_Documentos` consentimientos de tratamiento de datos de pacientes

**Auditor√≠as de Cumplimiento**:
- Programar en `Plan_Auditoria` auditor√≠as espec√≠ficas de:
  - Accesos a historias cl√≠nicas (logs de qui√©n vio qu√© paciente)
  - Cifrado de datos en reposo y en tr√°nsito
  - Procesos de anonimizaci√≥n/pseudonimizaci√≥n
  - Retenci√≥n y eliminaci√≥n segura de datos m√©dicos

**Resultado Esperado**: Cumplimiento simult√°neo de ISO 27001 + GDPR, cero sanciones regulatorias

---

## üìö Recursos Complementarios

### üìñ **Documentaci√≥n de Referencia**

- üîó [ISO/IEC 27001:2022](https://www.iso.org/standard/27001.html) - Norma oficial de gesti√≥n de seguridad de la informaci√≥n
- üîó [MITRE ATT&CK v17.1](https://attack.mitre.org/) - Framework de t√°cticas y t√©cnicas de ataque
- üîó [NIST Cybersecurity Framework](https://www.nist.gov/cyberframework) - Marco de ciberseguridad complementario
- üîó [GDPR Official Text](https://gdpr.eu/) - Reglamento General de Protecci√≥n de Datos (UE)
- üîó [CIS Controls v8](https://www.cisecurity.org/controls/) - Controles cr√≠ticos de seguridad

### üõ†Ô∏è **Herramientas Complementarias**

| Herramienta | Prop√≥sito | Integraci√≥n con SGSI |
|-------------|-----------|----------------------|
| **Vulnerability Scanners** (Nessus, OpenVAS) | Escaneo de vulnerabilidades | Alimenta `Inventario_Vulnerabilidades` |
| **SIEM** (Splunk, ELK Stack) | Monitoreo y correlaci√≥n de eventos | Genera alertas para `Gestion_Incidentes` |
| **Backup Solutions** (Veeam, Acronis) | Respaldo y recuperaci√≥n | Evidencias para `DRP_Informes` |
| **GRC Platforms** (NAVEX, LogicGate) | Governance, Risk, Compliance | Importa datos desde hojas Excel |
| **Threat Intelligence** (ThreatConnect) | Inteligencia de amenazas | Enriquece `MITRE_Ataques` |

### üéì **Formaci√≥n Recomendada**

Para maximizar el uso del sistema, se recomienda formaci√≥n en:

1. **ISO 27001 Lead Implementer** (5 d√≠as)
   - Profundizaci√≥n en requisitos de la norma
   - Metodolog√≠a de implementaci√≥n paso a paso
   - Preparaci√≥n para auditor√≠as de certificaci√≥n

2. **Risk Management** (ISO 31000)
   - Metodolog√≠as avanzadas de an√°lisis de riesgos
   - T√©cnicas cualitativas y cuantitativas
   - Integraci√≥n de riesgo en decisiones de negocio

3. **MITRE ATT&CK for ICS** (Workshop)
   - Aplicaci√≥n del framework a entornos industriales
   - Mapeo de defensas a t√©cnicas de ataque
   - Ejercicios de threat hunting

4. **Excel VBA Avanzado**
   - Personalizaci√≥n de macros del sistema
   - Creaci√≥n de nuevas automatizaciones
   - Integraci√≥n con bases de datos externas

---

## ü§ù Soporte y Mantenimiento

### üìû **Obtener Ayuda**

Si encuentras problemas o tienes dudas sobre el uso del sistema:

1. **Consultar la documentaci√≥n**:
   - Leer hoja `Instrucciones` dentro del Excel
   - Revisar este README completo
   - Consultar `MAPEO_BOTONES_MACROS_v4.md`

2. **Verificar compatibilidad**:
   - Leer `ANALISIS_COMPATIBILIDAD_MACROS_v4.md`
   - Validar versi√≥n de Excel (2016+ requerido)
   - Confirmar que macros est√°n habilitadas

3. **Validaci√≥n del sistema**:
   - Ejecutar macro `ValidarIntegridad` (Alt+F8)
   - Revisar `Log_Acciones` para identificar errores
   - Probar hiperv√≠nculos del `Panel_Control`

### üîÑ **Actualizaciones del Sistema**

Para mantener el SGSI actualizado:

**Mensual**:
- ‚úÖ Actualizar `MITRE_Ataques` con nuevas t√©cnicas publicadas
- ‚úÖ Revisar y cerrar incidentes resueltos en `Gestion_Incidentes`
- ‚úÖ Generar `ReporteIncidentes` y presentar a comit√© de seguridad
- ‚úÖ Ejecutar `DashboardActualizar` antes de reuniones ejecutivas

**Trimestral**:
- ‚úÖ Realizar `Revision_Direccion` con alta direcci√≥n
- ‚úÖ Ejecutar auditor√≠as internas seg√∫n `Plan_Auditoria`
- ‚úÖ Actualizar `Metricas_KPI` y validar cumplimiento de objetivos (‚â•90%)
- ‚úÖ Revisar y actualizar `Inventario_Vulnerabilidades`

**Anual**:
- ‚úÖ Actualizar `Plan_Formacion` con temas emergentes
- ‚úÖ Revisar y aprobar todas las `Politicas_Seguridad`
- ‚úÖ Ejecutar pruebas completas de `DRP_Pruebas` (simulacro de desastre)
- ‚úÖ Actualizar `Plan_Director_Ciber` con iniciativas del pr√≥ximo a√±o
- ‚úÖ Realizar an√°lisis de riesgos completo (nueva iteraci√≥n)

### üîß **Mantenimiento Preventivo**

Para garantizar el rendimiento √≥ptimo del sistema:

1. **Limpieza de datos** (semestral):
   - Archivar `Log_Acciones` antiguos (>1 a√±o)
   - Eliminar registros obsoletos de activos dados de baja
   - Comprimir archivo Excel (Archivo ‚Üí Informaci√≥n ‚Üí Inspeccionar documento)

2. **Validaci√≥n de integridad** (trimestral):
   - Ejecutar macro `ValidarIntegridad`
   - Verificar que todas las f√≥rmulas de KPIs funcionen
   - Probar todos los hiperv√≠nculos del `Panel_Control`

3. **Backup** (semanal):
   - Respaldar el archivo `.xlsm` completo
   - Almacenar copias en ubicaci√≥n segura (cifrada)
   - Mantener al menos 3 versiones hist√≥ricas

---

## üéØ Mejores Pr√°cticas de Uso

### ‚úÖ **Recomendaciones Generales**

1. **Mant√©n la estructura intacta**:
   - ‚ùå NO elimines hojas ni cambies nombres
   - ‚ùå NO modifies f√≥rmulas en KPIs manualmente
   - ‚ùå NO elimines filas de encabezado
   - ‚úÖ Usa las macros para operaciones complejas

2. **Documentaci√≥n consistente**:
   - ‚úÖ Registra evidencias de controles implementados
   - ‚úÖ Adjunta capturas de pantalla en `Control_Documentos`
   - ‚úÖ Completa el campo "Descripci√≥n" en todos los registros
   - ‚úÖ Usa nomenclatura est√°ndar (ej: ACT-2025-001, RIS-2025-015)

3. **Revisi√≥n continua**:
   - ‚úÖ Revisa `Dashboard` semanalmente
   - ‚úÖ Actualiza estados de tratamiento mensualmente
   - ‚úÖ Cierra incidentes a tiempo (no acumular)
   - ‚úÖ Mant√©n `Config_Areas` y `Config_Categorias` al d√≠a

4. **Comunicaci√≥n efectiva**:
   - ‚úÖ Comparte `ReporteCompleto` con alta direcci√≥n (trimestral)
   - ‚úÖ Presenta `MapaCalor` en reuniones de comit√© de seguridad
   - ‚úÖ Usa `Dashboard` para comunicar progreso a stakeholders
   - ‚úÖ Documenta decisiones importantes en `Revision_Direccion`

### ‚ö° **Optimizaci√≥n del Rendimiento**

Si el archivo Excel se vuelve lento (>20 MB):

1. **Reducir historial de logs**:
   - Mantener solo √∫ltimos 1000 registros en `Log_Acciones`
   - Archivar registros antiguos en archivo separado

2. **Optimizar f√≥rmulas**:
   - Evitar f√≥rmulas vol√°tiles (NOW(), TODAY()) en muchas celdas
   - Usar `C√°lculo Manual` si trabajas con grandes vol√∫menes (F√≥rmulas ‚Üí Opciones de c√°lculo)

3. **Limpiar formato condicional**:
   - Eliminar reglas de formato condicional no usadas
   - Simplificar reglas complejas con m√∫ltiples condiciones

---

## üìä Estad√≠sticas del Sistema SGSI v4.0

```
üìÅ Archivo principal:              SGSI_COMPLETO_v4.0_FINAL_34HOJAS.xlsx
üìä Total de hojas:                 45 hojas organizadas en 13 m√≥dulos
ü§ñ Macros VBA:                     21 macros automatizadas
üîê Controles ISO 27001:2022:       93 controles (100% Anexo A)
üìú Pol√≠ticas de seguridad:         10 pol√≠ticas fundamentales
üéØ Procedimientos operativos:      12 procedimientos documentados
üó∫Ô∏è T√©cnicas MITRE ATT&CK:         Cat√°logo completo v17.1
üìà KPIs principales:               5 indicadores clave
üîó Hiperv√≠nculos de navegaci√≥n:    23 enlaces interactivos
‚è±Ô∏è Tiempo de implementaci√≥n:      12 meses (roadmap completo)
üéØ Objetivo de cumplimiento:       ‚â•90% controles implementados
‚úÖ Estado:                         Listo para certificaci√≥n ISO 27001
```

---

<div align="center">

## üõ°Ô∏è Sistema de Gesti√≥n de Seguridad de la Informaci√≥n

### **Soluci√≥n Integral para Certificaci√≥n ISO 27001:2022**

---

### üéØ **Beneficios Clave**

| Caracter√≠stica | Beneficio |
|----------------|-----------|
| ‚úÖ **100% Cumplimiento ISO 27001** | Todos los requisitos cubiertos |
| üìä **45 Hojas Organizadas** | Navegaci√≥n intuitiva por m√≥dulos |
| ü§ñ **21 Macros Automatizadas** | Ahorro de 70% de tiempo operativo |
| üîê **93 Controles Documentados** | Anexo A completo con evidencias |
| üéØ **Dashboard Ejecutivo** | Visibilidad de m√©tricas en tiempo real |
| üìù **Trazabilidad Completa** | Log autom√°tico de todas las acciones |
| üó∫Ô∏è **MITRE ATT&CK Integrado** | An√°lisis de amenazas actualizado |
| üîÑ **BCP + DRP Completo** | Continuidad operacional garantizada |

---

### üìÇ **Archivos del Sistema**

| Archivo | Descripci√≥n |
|---------|-------------|
| `SGSI_COMPLETO_v4.0_FINAL_34HOJAS.xlsx` | üìä Archivo principal (45 hojas) |
| `SGSI_COMPLETO_v3.0_Macros.txt` | ü§ñ C√≥digo VBA (21 macros, 2807 l√≠neas) |
| `README.md` | üìñ Este archivo - Gu√≠a completa |
| `MAPEO_BOTONES_MACROS_v4.md` | üó∫Ô∏è Mapeo de botones a macros |
| `ANALISIS_COMPATIBILIDAD_MACROS_v4.md` | ‚úÖ An√°lisis de compatibilidad |

---

### üöÄ **¬°Comienza Hoy tu Certificaci√≥n ISO 27001!**

**Pasos Inmediatos**:
1. ‚úÖ Descarga el archivo Excel
2. ‚úÖ Convierte a formato `.xlsm`
3. ‚úÖ Importa las 21 macros VBA
4. ‚úÖ Personaliza `Datos_Organizacion`
5. ‚úÖ ¬°Comienza a usar el sistema!

---

### üìû **Pr√≥ximos Pasos**

Para auditor√≠a de certificaci√≥n:
- üìã Completar todos los 93 controles
- üìä Generar evidencias con macros
- üîç Ejecutar auditor√≠a interna
- üëî Revisi√≥n final por direcci√≥n
- üéâ **¬°Obtener certificaci√≥n ISO 27001!**

---

</div>

**Desarrollado con** ‚ù§Ô∏è **para profesionales de seguridad de la informaci√≥n**

**Versi√≥n del README**: 2.0 (Actualizado para SGSI v4.0)  
**√öltima actualizaci√≥n**: Enero 2025  
**Estado**: ‚úÖ Producci√≥n - Listo para Certificaci√≥n

---

